# Working with containers on LUMI

## Base containers

Machine learning frameworks on LUMI are served as isolated environments in a form of container images with fundametal set of Python packages. LUMI uses the [Singularity](https://docs.sylabs.io/guides/main/user-guide/) (SingularityCE) container runtime.

Containers can be seen as encapsulated images of a specific environment including all libraries and tools and most importantly python packages. Container image can be based on virtually any linux distribution targeting host architecture but it still relies on host kernel and kernel drivers. This plays significant role in the case of LUMI.

The motivation for using base containers is twofold: 

 - compatibility with ROCm (GPU runtime) and Slingshot network (inter-node communication), 
 - filesystem use optimization (encapsulation limits filesystem load generated by accessing many small files).

Althouht this implies base images are not portable which is usually expected from containers. These images unlikely run on other system. 

Base images are available as flat sif files stored at the shared filesystem. 

## Interacting with a containerized environment

Python environment from an image can be accesed either interactively with spawning a shell instance within a container (`sinularity shell` command) or by executing command within a container (`singularity exec` command). Do not expert actual runscript, you need to execute your own script. 

## Singularity and Slurm

## Installing additional packages in a container 

### Using cotainr tool to extend existing image

## Custom images

User can also bring own container image or convert Docker image to singularity format.
